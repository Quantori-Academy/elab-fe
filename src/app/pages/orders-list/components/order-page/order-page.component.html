@if (order$ | async; as order) {
<div class="info">
  <div>
    <img src="/assets/icons/order.svg" alt="Order list" />
  </div>
  <div>
    <h2>
      Order Title: <span>{{ order.title }}</span>
    </h2>
    <h2>
      Seller: <span>{{ order.seller }}</span>
    </h2>
    <h3>
      Status: <span>{{ order.status }}</span>
    </h3>
    <h3>
      Created: <span>{{ order.createdAt | date : "dd/MM/yyyy - HH:mm" }}</span>
    </h3>

    @if (order.updatedAt === '') {
    <h3>
      Last updated:
      <span>{{ order.createdAt | date : "dd/MM/yyyy - HH:mm" }}</span>
    </h3>
    }@else {
    <h3>
      Updated: <span>{{ order.updatedAt | date : "dd/MM/yyyy - HH:mm" }}</span>
    </h3>
    }
  </div>
</div>
<h3>Ordered Reagents</h3>
<div class="table-container mat-elevation-z8">
  <div class="table-content">
    <table mat-table [dataSource]="order.reagents">
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef> Name </th>
      <td mat-cell *matCellDef="let element">{{ element.name }} </td>
    </ng-container>

    <ng-container matColumnDef="casNumber">
      <th mat-header-cell *matHeaderCellDef> casNumber </th>
      <td mat-cell *matCellDef="let element">
        @if (element.casNumber === null || element.casNumber === '' ) {
        <span>N/A</span>
        }@else { {{ element.casNumber }} }
      </td>
    </ng-container>

    <ng-container matColumnDef="updatedAt">
      <th mat-header-cell *matHeaderCellDef>Modification Date</th>
      <td mat-cell *matCellDef="let element">
        @if (element.updatedAt === '') {
        <span>N/A</span>
        }@else { {{ element.updatedAt | date : "HH:mm:ss  dd-MM-yyyy" }}}
      </td>
    </ng-container>

      <ng-container matColumnDef="desiredQuantity">
        <th th mat-header-cell *matHeaderCellDef> Desired Quantity </th>
        <td td mat-cell *matCellDef="let element">
          {{ element.desiredQuantity }} {{ element.quantityUnit }}
        </td>
      </ng-container>

    <ng-container matColumnDef="package">
      <th mat-header-cell *matHeaderCellDef> Package </th>
      <td mat-cell *matCellDef="let element">
        @if (element.package === null) {
        <span>N/A</span>
        }@else { {{ element.package }} }
      </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef> status </th>
      <td mat-cell *matCellDef="let element">
        <span
          class="status-label"
          [ngClass]="{
            'status-pending': element.status === 'Pending',
            'status-fulfilled': element.status === 'Fulfilled',
            'status-declined': element.status === 'Declined',
            'status-submitted': element.status === 'Ordered',
            'status-completed': element.status === 'Completed'
          }"
        >
          {{ element.status }}
        </span>
      </td>
    </ng-container>

      <ng-container matColumnDef="structureSmiles">
        <th th mat-header-cell *matHeaderCellDef>Structure</th>
        <td td mat-cell *matCellDef="let element" class="structure-container">
          <app-molecule-structure
            [structure]="element.structureSmiles"
            [width]="100"
            [height]="100"
          ></app-molecule-structure>
        </td>
      </ng-container>

    <ng-container matColumnDef="userComments">
      <th mat-header-cell *matHeaderCellDef> Creator's comment </th>
      <td mat-cell *matCellDef="let element">
        @if (element.userComments === null|| element.userComments === '') {
        <span>N/A</span>
        } @else{
        {{ element.userComments }}
        }
      </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef> Actions </th>
      <td mat-cell *matCellDef="let element">
        @if (element.status ==='Completed'){
        <button class="add-btn" mat-flat-button disabled="true">
          completed
        </button>
        } @else if (element.status === 'Fulfilled') {
        <button
          class="add-btn"
          mat-flat-button
          (click)="onCompleted(element.id)"
        >
          complete
        </button>
        }@else if (element.status === 'Ordered') {
        <button mat-icon-button aria-label="edit" (click)="onOpen(element)">
          <mat-icon color="primary">edit</mat-icon>
        </button>
        <button
          mat-icon-button
          aria-label="delete"
          (click)="onRemove(order.id, element)"
        >
          <mat-icon color="warn">delete</mat-icon></button
        >}
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
</table>
  @if (!order.reagents.length) {
    <app-no-data text="No Ordered Reagents"/>
  }
  </div>
</div>
} @else {
<app-table-loader-spinner />
}
